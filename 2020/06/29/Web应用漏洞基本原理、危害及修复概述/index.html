<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="fzykn06's blog"><meta name="keywords" content="信安, 前端, 后端"><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.4"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.4"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="stylesheet" type="text/css" href="https://unpkg.com/gitalk/dist/gitalk.css?v=2.0.4"><title>Web应用漏洞基本原理、危害及修复概述 | fzykn06's blog</title><meta name="generator" content="Hexo 4.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Web应用漏洞基本原理、危害及修复概述</h1><a id="logo" href="/.">fzykn06's blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="搜索"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">Web应用漏洞基本原理、危害及修复概述</h1><div class="post-meta"><a href="/2020/06/29/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E3%80%81%E5%8D%B1%E5%AE%B3%E5%8F%8A%E4%BF%AE%E5%A4%8D%E6%A6%82%E8%BF%B0/#comments" class="comment-count"></a><p><span class="date">Jun 29, 2020</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><p>本文来源mnask师傅的电子书籍：<a href="https://nmask.gitbooks.io/vulnerability-box/" target="_blank" rel="noopener">https://nmask.gitbooks.io/vulnerability-box/</a> 内容和书内基本一致，若侵权请尽快联系我删除文章：qq793029568</p>
<h2 id="0x01-SQL注入漏洞–高危"><a href="#0x01-SQL注入漏洞–高危" class="headerlink" title="0x01 SQL注入漏洞–高危"></a>0x01 SQL注入漏洞–高危</h2><h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>sql注入（SQL Injection）漏洞产生的原因是网站应用程序在编写时未对用户提交至服务器的数据进行合法性校验，即没有进行有效的特殊字符过滤，导致网站服务器存在安全风险。</p>
<h3 id="漏洞危害"><a href="#漏洞危害" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>机密数据被窃取</li>
<li>核心业务数据被篡改</li>
<li>网页被篡改</li>
<li>数据库所在服务器被攻击从而变为傀儡主机，导致局域网（内网）被入侵</li>
</ul>
<h3 id="修复建议"><a href="#修复建议" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>在网页代码中对用户输入的数据进行严格过滤；（代码层）</li>
<li>部署Web应用防火墙；（设备层）</li>
<li>对数据库操作进行监控（数据库层）</li>
</ul>
<p>在代码层最佳防御sql漏洞方案：采用sql语句预编译和绑定变量，即采用PreparedStatement。</p>
<p>PreparedStatement是Statement的一个子类，主要的功能是将sql语句<code>select id,no from user where id=?</code>预先编译好，也就是sql引擎会预先进行语法分析，产生相应的语法数，生成执行计划，即用户输入的信息只会去替代语句中变量后面的 <code>?</code>不会影响到语句的具体结构，无论输入的参数是什么，都不会去影响sql的语法结构，因为语法的分析已经结束了，而语法分析主要是分析sql命令。即使键入了select,from,where,and,or,order by 等，也不会被作为sql语句来执行，只会被当做是字符串面值参数。所以sql预编译是可以防御sql注入的。</p>
<p>其他防御方式：后端sql语句前通过正则匹配的方式过滤一些敏感字符。</p>
<h2 id="0x02-目录遍历漏洞–中危"><a href="#0x02-目录遍历漏洞–中危" class="headerlink" title="0x02 目录遍历漏洞–中危"></a>0x02 目录遍历漏洞–中危</h2><h3 id="漏洞描述-1"><a href="#漏洞描述-1" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>该漏洞主要是可以获取到系统问键及服务器的配置文件，利用服务器API、文件标准权限进行攻击。</p>
<h3 id="漏洞危害-1"><a href="#漏洞危害-1" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>攻击者可以通过该漏洞获得服务器上的文件目录结构，从而下载到敏感的文件。</p>
<h3 id="修复建议-1"><a href="#修复建议-1" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>可通过修改配置文件，去除中间件（如IIS、Apache、Tomcat等）的文件目录索引功能</li>
<li>设置目录权限</li>
<li>在每个木库下创建一个空的index.html页面</li>
</ul>
<h2 id="0x03-跨站脚本漏洞（XSS）"><a href="#0x03-跨站脚本漏洞（XSS）" class="headerlink" title="0x03 跨站脚本漏洞（XSS）"></a>0x03 跨站脚本漏洞（XSS）</h2><h3 id="漏洞描述-2"><a href="#漏洞描述-2" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>XSS漏洞，是利用跨站脚本漏洞可以在网站中插入任意的代码，它能够获取网站管理员或普通用户的cookie，隐蔽运行网页木马，或者是格式化浏览者的硬盘。</p>
<h3 id="漏洞危害-2"><a href="#漏洞危害-2" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者可进行网络钓鱼，盗取管理员或用户账号及密码等隐私信息。</li>
<li>可劫持合法用户会话，利用管理员身份进行恶意操作，篡改页面内容，进一步渗透网站。</li>
<li>可进行网页挂马，传播跨站脚本蠕虫病毒等。</li>
<li>可控制受害者极其向其他系统发起攻击。</li>
</ul>
<h3 id="修复建议-2"><a href="#修复建议-2" class="headerlink" title="修复建议"></a>修复建议</h3><h4 id="设置httponly"><a href="#设置httponly" class="headerlink" title="设置httponly"></a>设置httponly</h4><p>httponly无法完全的防御xss漏洞，只能够规定不是使用js去获取相关的cookie的内容，因此它只能防御利用xss进行cookie劫持问题，Httponly是在set-cookie时进行标记的，可对单独某个参数进行全部标记。由于设置httponly的方法比较简单，使用也较为的灵活，并且对防御cookie劫持非常有用，因此就逐渐成功一种默认的标准。</p>
<h4 id="XSS-filter"><a href="#XSS-filter" class="headerlink" title="XSS filter"></a>XSS filter</h4><p>Xss filter往往是一个文本文件，里面包含允许被用户输入提交的字符。主要的检测的点在于用户输入的时候，xss filter分为白名单与黑名单，推荐使用白名单，但即使使用白名单还是无法完全杜绝xss问题，并且使用不当可能有较高的误报率。</p>
<h4 id="编码转义"><a href="#编码转义" class="headerlink" title="编码转义"></a>编码转义</h4><p>编码方式较多，可html编码、url编码、16进制编码、javascript编码等。在处理用户输入时，除用xss filter的方式过滤一些敏感字符外，还需要配合使用编码的方式，将一些敏感的字符通过编码的方式改变原来的样子，从而不能被浏览器当成js代码执行。</p>
<h4 id="处理富文本"><a href="#处理富文本" class="headerlink" title="处理富文本"></a>处理富文本</h4><p>目前有些网页编辑器允许用户使用一些自定义的html代码，称之为富文本。在富文本中防御xss漏洞就要控制用户能使用的标签，限制为只能使用a、div等安全标签。</p>
<h4 id="输出类型xss漏洞"><a href="#输出类型xss漏洞" class="headerlink" title="输出类型xss漏洞"></a>输出类型xss漏洞</h4><p>xss漏洞的本质就是通过html页面进行注入，也就是将html代码提交到网页中，name其防御的根本就是在用户提交的代码显示到页面上时做好一系列的过滤与转义。</p>
<h4 id="其他修复"><a href="#其他修复" class="headerlink" title="其他修复"></a>其他修复</h4><ul>
<li><p>开发者需要严格安全openid和openkey的校验规则判断openid和openkey是否合法，且判断其他参数的合法性，不合法不返回任何内容。</p>
</li>
<li><p>严格限制URL参数输入值的格式，不能包含不必要的特殊字符（%0d、%0a、%0D、%0A等）。</p>
</li>
<li><p>针对ASP.NET的防XSS库，Microsoft有提供统一的库。</p>
</li>
<li><p>具体的js方法如下：</p>
<ul>
<li><p>对于用户输入的参数值展现在html正文中或者属性值中的情况</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">展现在html正文中：&lt;a href=<span class="string">'http://www.contoso.com'</span>&gt;Un-<span class="keyword">trusted</span> <span class="keyword">input</span>&lt;/a&gt; 展现在属性值中：</span><br><span class="line">&lt;<span class="keyword">input</span> <span class="type">name</span>="searchword" <span class="keyword">value</span>="Un-trusted input"&gt; 此时需要将红色的不可信内容中做如下的转码(即将&lt;&gt; ‘ “ ` 转成html实体)： </span><br><span class="line">&lt;  -&gt;  &amp;lt;</span><br><span class="line">&gt;  -&gt;  &amp;gt;</span><br><span class="line"><span class="string">'  -&gt;  &amp;#39;</span></span><br><span class="line"><span class="string">"  -&gt;  &amp;quto;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>对于用户输入在<code>&lt;script&gt;</code>的内容中的情况，例如：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script <span class="keyword">type</span>="text/javascript"&gt; … var mymsg="Un-trusted input"; var uin=Un-<span class="keyword">trusted</span> <span class="keyword">input</span>; … &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">"  -&gt;  \x34</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h2 id="0x04-未过滤HTM代码漏洞"><a href="#0x04-未过滤HTM代码漏洞" class="headerlink" title="0x04 未过滤HTM代码漏洞"></a>0x04 未过滤HTM代码漏洞</h2><h3 id="漏洞描述-3"><a href="#漏洞描述-3" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>由于页面过滤HTML代码，攻击者可通过构造XSS代码（或绕过防火墙保护策略），实现跨站脚本攻击等。</p>
<h3 id="漏洞危害-3"><a href="#漏洞危害-3" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>恶意用户可使用JavaScript、VBScript、ActiveX、HTML语言甚至Flash利用应用漏洞，从而获取用户信息</li>
<li>攻击者能盗取会话cookie、获取账户、模拟其他用户身份，可修改网页呈现给其他用户的内容。</li>
</ul>
<h3 id="修复建议-3"><a href="#修复建议-3" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>严格过滤用户输入的数据</li>
<li>可参考跨站脚本漏洞修复方案</li>
</ul>
<h2 id="0x05-数据库运行出错"><a href="#0x05-数据库运行出错" class="headerlink" title="0x05 数据库运行出错"></a>0x05 数据库运行出错</h2><h3 id="漏洞描述-4"><a href="#漏洞描述-4" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>网站存在数据库运行出错，由于网页数据交换出错，攻击者可获取报错中的敏感信息，即sql报错注入类型等。</p>
<h3 id="漏洞危害-4"><a href="#漏洞危害-4" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>加密数据可被窃取</li>
<li>攻击者通过构造特殊URL地址，触发系统web应用程序报错，在回显内容中，获取敏感网站信息</li>
<li>攻击者利用漏洞泄露的敏感信息获取网站服务器web路径，为进一步攻击提供帮助</li>
</ul>
<h3 id="修复建议-4"><a href="#修复建议-4" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>检查数据库缓存是否溢出，是否具有失效的配置管理，禁用一切不必要的功能</li>
<li>对网站错误信息进行统一返回，模糊化处理</li>
</ul>
<h2 id="0x06-Flash安全配置缺陷漏洞"><a href="#0x06-Flash安全配置缺陷漏洞" class="headerlink" title="0x06 Flash安全配置缺陷漏洞"></a>0x06 Flash安全配置缺陷漏洞</h2><h3 id="漏洞描述-5"><a href="#漏洞描述-5" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>网站存在Flash安全配置缺陷，该漏洞可导致跨域访问，让用户访问非法Flash文件</p>
<ul>
<li>allowScriptAccess:是否允许flash访问浏览器脚本如果不对不信任的flash限制，默认会允许调用浏览器脚本，产生XSS漏洞。<ul>
<li>always（默认值），总是允许</li>
<li>sameDomain，同域允许；</li>
<li>never，不允许</li>
</ul>
</li>
<li>allowNetworking:是否允许flash访问ActionScript中的网络API。如果不对不信任的flash限制，会带来flash弹窗、CSRF等问题。<ul>
<li>all，允许所有功能，会带来flash弹窗危害；</li>
<li>internal，可以向外发送请求、加载网页</li>
<li>none，无法进行任何网路相关动作（业务正常功能可能无法使用）</li>
</ul>
</li>
</ul>
<h3 id="漏洞危害-5"><a href="#漏洞危害-5" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>网站的Flash配置文件crossdomain.xml配置不当，当存在Flash跨域攻击安全隐患</p>
<h3 id="修复建议-5"><a href="#修复建议-5" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>修改flash安全策略，做严格限制，比如限制到网站当前域</li>
<li>找到相应目录下的crossdomain.xml文件，将其中的cross-domain-policy allow-access-fromdomain=* cross-domain-policy改成：cross-domain-policy allow-access-from domain=改成你的网站地址 cross-domain-policy。</li>
</ul>
<h2 id="0x07-FCK编辑器泄露漏洞"><a href="#0x07-FCK编辑器泄露漏洞" class="headerlink" title="0x07 FCK编辑器泄露漏洞"></a>0x07 FCK编辑器泄露漏洞</h2><h3 id="漏洞描述-6"><a href="#漏洞描述-6" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>利用此漏洞的攻击者可访问编辑器页面，上传图片</p>
<h3 id="漏洞危害-6"><a href="#漏洞危害-6" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>由于网站编辑器没有对管理员登录进行校验，导致任意用户访问编辑器</li>
<li>利用编辑器漏洞查看网站全硬盘目录</li>
</ul>
<h3 id="修复建议-6"><a href="#修复建议-6" class="headerlink" title="修复建议"></a>修复建议</h3><p>对编辑器页面进行访问控制，进制未授权的访问，并升级fck编辑器版本。</p>
<h2 id="0x08-FCK-editor任意文件上传漏洞"><a href="#0x08-FCK-editor任意文件上传漏洞" class="headerlink" title="0x08 FCK editor任意文件上传漏洞"></a>0x08 FCK editor任意文件上传漏洞</h2><h3 id="漏洞描述-7"><a href="#漏洞描述-7" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>FCK editor版本低于或等于2.4.3时网站存在任意文件上传漏洞们可以利用该漏洞上传任意文件。</p>
<h3 id="漏洞危害-7"><a href="#漏洞危害-7" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>由于目标网站为做上传格式的限制，导致网站、数据库和服务器有被入侵的风险；</li>
<li>可能导致网站被攻击者控制，网站数据被窃取、网页被篡改等</li>
</ul>
<h3 id="修复建议-7"><a href="#修复建议-7" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>设置FCK editor编辑器相关页面在为授权的前提下无法正常访问，和限制FCK上传文件的格式</li>
<li>下载并更新值FCK editor的最新版本</li>
</ul>
<h2 id="0x09-URL-Redirect漏洞"><a href="#0x09-URL-Redirect漏洞" class="headerlink" title="0x09 URL Redirect漏洞"></a>0x09 URL Redirect漏洞</h2><h3 id="漏洞描述-8"><a href="#漏洞描述-8" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>URL Redirect漏洞即URL重定向漏洞，通过URL修改为指向恶意站点，攻击者可以成功发起网络钓鱼诈骗并获取用户相关信息。</p>
<h3 id="漏洞危害-8"><a href="#漏洞危害-8" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>web应用程序执行指向外部站点的重定向</li>
<li>攻击者可能会使用web服务器攻击其他站点，增加匿名性</li>
</ul>
<h3 id="修复建议-8"><a href="#修复建议-8" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>在网页代码中需要对用户输入的数据进行严格过滤（代码层）</li>
<li>部署web应用防火墙（设备层）</li>
</ul>
<h2 id="0x10-文件上传漏洞"><a href="#0x10-文件上传漏洞" class="headerlink" title="0x10 文件上传漏洞"></a>0x10 文件上传漏洞</h2><h3 id="漏洞描述-9"><a href="#漏洞描述-9" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>站点存在任意文件上传漏洞，文件上传功能没有进行格式限制，容易被攻击者利用上传恶意脚本文件</p>
<h3 id="漏洞危害-9"><a href="#漏洞危害-9" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者可通过次漏洞上传恶意脚本文件，对服务器的正常运行造成安全威胁</li>
<li>攻击者可上传可执行的WebShell（如php、jsp、asp类型的木马病毒），或者利用目录跳转上传gif、html、config文件，覆盖原有的系统文件，达到获取系统权限的目的。</li>
</ul>
<h3 id="修复建议-9"><a href="#修复建议-9" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>对上传文件格式进行严格校验及安全扫描，防止上传恶意脚本文件</li>
<li>设置权限限制，进制上传目录的执行权限</li>
<li>严格限制可上传的文件路径</li>
<li>文件扩展名服务端白名单校验</li>
<li>文件内容服务端检验</li>
<li>上传文件重命名</li>
<li>隐藏上传文件路径</li>
</ul>
<h2 id="0x11-后台弱口令漏洞"><a href="#0x11-后台弱口令漏洞" class="headerlink" title="0x11 后台弱口令漏洞"></a>0x11 后台弱口令漏洞</h2><h3 id="漏洞描述-10"><a href="#漏洞描述-10" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>网站管理后台用户名密码较为简单或为默认，容易被攻击者进行爆破</p>
<h3 id="漏洞危害-10"><a href="#漏洞危害-10" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者利用弱口令登录网站管理后台，可任意增删文章等造成负面影响</li>
<li>攻击者可进一步查看网站信息，获取服务器权限，导致整个局域网被入侵</li>
</ul>
<h3 id="修复建议-10"><a href="#修复建议-10" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>对管理后台进行访问控制，修改后台弱口令，加强口令强度并定期修改</li>
<li>增加验证机制，防爆破机制，限制ip+cookie访问次数</li>
</ul>
<h2 id="0x12-敏感信息泄露漏洞"><a href="#0x12-敏感信息泄露漏洞" class="headerlink" title="0x12 敏感信息泄露漏洞"></a>0x12 敏感信息泄露漏洞</h2><h3 id="漏洞描述-11"><a href="#漏洞描述-11" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>由于网站运维人员疏忽，存放敏感信息的文件被泄露或者由于网站运行出错导致敏感信息泄露</p>
<h3 id="漏洞危害-11"><a href="#漏洞危害-11" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者可直接下载用户相关信息，包括网站的绝对路径、用户的登录名、密码、真实姓名、身份证号、电话号码、邮箱、QQ号等</li>
<li>攻击者通过构造特殊URL地址，触发系统web应用程序报错，在回显内容中，获取网站敏感信息</li>
<li>攻击者利用泄露的敏感信息，获取网站服务器web路径，为进一步攻击提供帮助</li>
</ul>
<h3 id="修复建议-11"><a href="#修复建议-11" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>对网站错误信息进行统一返回，模糊化处理</li>
<li>对存放敏感信息的文件加密并妥善存储，避免泄露敏感信息</li>
</ul>
<h2 id="0x13-未加密登录请求漏洞"><a href="#0x13-未加密登录请求漏洞" class="headerlink" title="0x13 未加密登录请求漏洞"></a>0x13 未加密登录请求漏洞</h2><h3 id="漏洞描述-12"><a href="#漏洞描述-12" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>网站对用户登录认证信息未进行加密，敏感信息以明文形式进行传送，易在传输过程中被获取。</p>
<h3 id="漏洞危害-12"><a href="#漏洞危害-12" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>易造成用户敏感信息泄露与篡改</li>
</ul>
<h3 id="修复建议-12"><a href="#修复建议-12" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>建议通过加密连接（如：SSL）方式进行敏感信息的传送</li>
</ul>
<h2 id="0x14-后台口令暴力破解"><a href="#0x14-后台口令暴力破解" class="headerlink" title="0x14 后台口令暴力破解"></a>0x14 后台口令暴力破解</h2><h3 id="漏洞描述-13"><a href="#漏洞描述-13" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>由于网站管理后台系统登录无验证码校验，可导致后台用户名密码被暴力破解</p>
<h3 id="漏洞危害-13"><a href="#漏洞危害-13" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者可利用该漏洞无限次提交用户名密码，从而可以暴力爆破后台用户名及密码</li>
<li>暴力破解后登录其中一个账号可进行管理后台，攻击者登录网站后台任意增删文件等造成负面影响</li>
<li>攻击者可进一步登录后天查看网站信息，上传恶意脚本文件，获取服务器权限，导致局域网（内网）被入侵</li>
</ul>
<h3 id="修复建议-13"><a href="#修复建议-13" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>对该页面进行访问控制，禁止外网ip或非法ip访问后台页面，并增加验证码校验，加强账号锁定机制</li>
<li>增加ip+cookie配置方式限制访问频率</li>
</ul>
<h2 id="0x15-跨站请求伪造（CSRF）"><a href="#0x15-跨站请求伪造（CSRF）" class="headerlink" title="0x15 跨站请求伪造（CSRF）"></a>0x15 跨站请求伪造（CSRF）</h2><h3 id="漏洞描述-14"><a href="#漏洞描述-14" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>跨站请求伪造，即CSRF，攻击者通过伪造来自受信任用户的请求，达到增加、删除、篡改网站内容的目的</p>
<h3 id="漏洞危害-14"><a href="#漏洞危害-14" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者冒充用户或者管理员，伪造请求，进行篡改、转账、改密码、发邮件等非法操作</li>
</ul>
<h3 id="修复建议-14"><a href="#修复建议-14" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>过滤用户输入，不允许发布含有站内操作URL的链接；</li>
<li>改良站内API的设计，关键操作使用验证码，只接受POST请求，GET请求应该只浏览而不改变服务器端资源</li>
<li>对于web站点，将持久化的授权方法（例如cookie或者HTTP授权）切换为瞬时的授权方法（在每个form中提供隐藏field）</li>
<li>在浏览其他站点前登出站点或者在浏览器会话结束后清理浏览器的cookie</li>
</ul>
<h3 id="服务器端防御"><a href="#服务器端防御" class="headerlink" title="服务器端防御"></a>服务器端防御</h3><ul>
<li>验证HTTP Referer字段</li>
<li>请求地址中添加token并验证（token不放在cookie中，放在http请求参数中，服务器端对其进行验证）</li>
<li>将token加入http头属性中，避免token出现在浏览器中，被泄露</li>
</ul>
<h3 id="客户端防御"><a href="#客户端防御" class="headerlink" title="客户端防御"></a>客户端防御</h3><p>为了配合服务器端对token的验证，name客户端也需要在访问时生成token，这是利用js来给html中的链接和表单请求地址附加csrftoken代码，其中已定义token为全局变量，其值可以从session中得到。</p>
<h2 id="0x16-Unicode编码转换漏洞–中危"><a href="#0x16-Unicode编码转换漏洞–中危" class="headerlink" title="0x16 Unicode编码转换漏洞–中危"></a>0x16 Unicode编码转换漏洞–中危</h2><h3 id="漏洞描述-15"><a href="#漏洞描述-15" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>该漏洞由于Unicode在编码转换过程中会忽略某些字符，导致攻击者可插入该字符绕过安全设备的检测</p>
<h3 id="漏洞危害-15"><a href="#漏洞危害-15" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者可通过插入特殊字符，可拆分攻击的关键词，绕过安全设备的检测</li>
</ul>
<h3 id="修复建议-15"><a href="#修复建议-15" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>修改中间件，过滤特殊字符</li>
<li>部署web应用防火墙</li>
</ul>
<h2 id="0x17-Possible-Net-Error-Message–中危"><a href="#0x17-Possible-Net-Error-Message–中危" class="headerlink" title="0x17 Possible .Net Error Message–中危"></a>0x17 Possible .Net Error Message–中危</h2><h3 id="漏洞描述-16"><a href="#漏洞描述-16" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>网站存在.net报错信息，由于网站为配置统一错误返回页面，导致aspx出错并显示出错误信息</p>
<h3 id="漏洞危害-16"><a href="#漏洞危害-16" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者可通过特殊的攻击向量，有可能泄露如绝对路径、源代码、sql语句等敏感信息，恶意攻击者很有可能利用这些信息实施进一步攻击。</li>
</ul>
<h3 id="修复建议-16"><a href="#修复建议-16" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>关闭php错误回显，或者修正代码</li>
</ul>
<h2 id="0x18-发生内部错误漏洞"><a href="#0x18-发生内部错误漏洞" class="headerlink" title="0x18 发生内部错误漏洞"></a>0x18 发生内部错误漏洞</h2><h3 id="漏洞描述-17"><a href="#漏洞描述-17" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>500 Internal Server Error</p>
<h3 id="漏洞危害-17"><a href="#漏洞危害-17" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>攻击者向服务器提交精心构造的恶意数据后，有可能导致服务器出现内部错误，服务器宕机或者数据库错乱</p>
<h3 id="修复建议-17"><a href="#修复建议-17" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>严格过滤用户输入的数据</li>
<li>服务器错误统一模糊处理，或者舔砖首页/404页面</li>
</ul>
<h2 id="0x19-SVN源代码泄露"><a href="#0x19-SVN源代码泄露" class="headerlink" title="0x19 SVN源代码泄露"></a>0x19 SVN源代码泄露</h2><h3 id="漏洞描述-18"><a href="#漏洞描述-18" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>由于目标网站没有及时清除SVN服务器连接时的残留信息，导致存在此漏洞</p>
<h3 id="漏洞危害-18"><a href="#漏洞危害-18" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者可利用该漏洞下载网站的源代码，获得数据库的连接密码等敏感信息</li>
<li>攻击者可通过源代码分析出新的系统漏洞，从而进一步入侵系统</li>
</ul>
<h3 id="修复建议-18"><a href="#修复建议-18" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>删除指定SVN生成的各种文件，如<code>/.svn/entries</code>等</li>
</ul>
<h2 id="0x20-旁站攻击漏洞"><a href="#0x20-旁站攻击漏洞" class="headerlink" title="0x20 旁站攻击漏洞"></a>0x20 旁站攻击漏洞</h2><h3 id="漏洞描述-19"><a href="#漏洞描述-19" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>多家网站在同一台服务器上，因一个网站存在致命高危漏洞，导致整台服务器被入侵</p>
<h3 id="漏洞危害-19"><a href="#漏洞危害-19" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>服务器上的所有网站均可被获得控制权限，攻击者可利用该漏洞登录网站后台任意增删文件等造成负面影响</li>
<li>攻击者可通过旁站服务器漏洞进行网站内网对其他服务器进行进一步攻击</li>
</ul>
<h3 id="修复建议-19"><a href="#修复建议-19" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>修补同一台服务器上的其他网站漏洞</li>
<li>建议每个网站单独服务器运行</li>
</ul>
<h2 id="0x21-后台登录页面绕过"><a href="#0x21-后台登录页面绕过" class="headerlink" title="0x21 后台登录页面绕过"></a>0x21 后台登录页面绕过</h2><h3 id="漏洞描述-20"><a href="#漏洞描述-20" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>越权操作，可直接通过访问后台地址进行访问，绕过登陆限制</p>
<h3 id="漏洞危害-20"><a href="#漏洞危害-20" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>一旦入侵者发现后台URL，便可进入后台页面，进行非法操作</li>
</ul>
<h3 id="修复建议-20"><a href="#修复建议-20" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>对后台所有url做好权限设置</li>
<li>禁止外网访问后台地址</li>
</ul>
<h2 id="0x22-CVS信息泄露"><a href="#0x22-CVS信息泄露" class="headerlink" title="0x22 CVS信息泄露"></a>0x22 CVS信息泄露</h2><h3 id="漏洞描述-21"><a href="#漏洞描述-21" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>由于目标网站没有及时清除CVS服务器连接时的残留信息，导致存在此漏洞</p>
<h3 id="漏洞测试"><a href="#漏洞测试" class="headerlink" title="漏洞测试"></a>漏洞测试</h3><p>访问 /cvs/等页面，若出现如下内容，则表示存在此漏洞</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XXX<span class="meta">@cvs</span>.cssweb.sh.<span class="string">cn:</span><span class="regexp">/cvs_2010/</span>project/gtja</span><br></pre></td></tr></table></figure>

<p>@前面的是用户名，后面的是服务器地址</p>
<h3 id="漏洞危害-21"><a href="#漏洞危害-21" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者可利用该漏洞下载网站的源代码，获取数据库的连接密码等敏感信息</li>
<li>攻击者可通过源代码分析出新的系统漏洞，从而进一步入侵系统</li>
</ul>
<h3 id="修复建议-21"><a href="#修复建议-21" class="headerlink" title="修复建议"></a>修复建议</h3><p>删除指定CVS生成的各种文件，如<code>/cvs/root</code>等</p>
<h2 id="0x23-Possible-PHP-Error-Message"><a href="#0x23-Possible-PHP-Error-Message" class="headerlink" title="0x23 Possible PHP Error Message"></a>0x23 Possible PHP Error Message</h2><h3 id="漏洞描述-22"><a href="#漏洞描述-22" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>网站存在Possible PHP Error Message，由于网站为配置统一错误返回页面，导致PHP出错并且出错误信息</p>
<h3 id="漏洞危害-22"><a href="#漏洞危害-22" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者可通过特殊的攻击向量，有可能泄露如绝对路径、源代码、sql语句等敏感信息，恶意攻击者很有可能利用这些信息实施进一步攻击</li>
</ul>
<h3 id="修复建议-22"><a href="#修复建议-22" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>关闭PHP错误回显，或修正代码</li>
</ul>
<h2 id="0x24-HPP漏洞"><a href="#0x24-HPP漏洞" class="headerlink" title="0x24 HPP漏洞"></a>0x24 HPP漏洞</h2><h3 id="漏洞描述-23"><a href="#漏洞描述-23" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>即http参数污染，是web容器处理http参数时的问题，比如访问URL:<a href="http://www.xxx.com/index.php?str=hello此时页面显示hello，但是如果访问：http://www.xxx.com/index.php?str=hello&amp;str=world此时，页面显示world，把前面参数的值给覆盖了，即http参数污染" target="_blank" rel="noopener">http://www.xxx.com/index.php?str=hello此时页面显示hello，但是如果访问：http://www.xxx.com/index.php?str=hello&amp;str=world此时，页面显示world，把前面参数的值给覆盖了，即http参数污染</a></p>
<h3 id="漏洞危害-23"><a href="#漏洞危害-23" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>用来绕过WAF</p>
<h3 id="修复建议-23"><a href="#修复建议-23" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>修改web容器处理机制</li>
</ul>
<h2 id="0x25-File-Operation-Web-xml漏洞"><a href="#0x25-File-Operation-Web-xml漏洞" class="headerlink" title="0x25 File Operation-Web.xml漏洞"></a>0x25 File Operation-Web.xml漏洞</h2><h3 id="漏洞描述-24"><a href="#漏洞描述-24" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>攻击者可通过文件内容泄露漏洞（或文件包含漏洞）获取敏感文件的内容，或至二级执行其指定的恶意脚本，进而得到web服务器的控制权限。</p>
<h3 id="漏洞危害-24"><a href="#漏洞危害-24" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>文件内容泄露漏洞（或文件包含漏洞）允许攻击者读取服务器中的任意文件，或通过特殊的指令将脚本源码文件的内容合并至当前的文件中执行</li>
<li>很多脚本语言允许通过特殊的指令（如PHP通过require关键字）将其他脚本源码文件的内容合并至当前的文件中执行，如果这些特殊的指令在包含的文件路径中含有用户提交的数据，则恶意攻击者就有可能通过构造特殊的数据将WEB服务器限制访问的文件内容（如操作系统或某些重要应用的配置文件）包含进来并通过浏览器获取其内容，这种方式通常称为本地文件包含；如果应用程序的配置还允许包含远程的其他服务器上的文件，恶意攻击者就有可能构造特殊的脚本然后通过包含并予以执行，进而获取web应用的敏感数据或控制权。</li>
</ul>
<h3 id="修复建议-24"><a href="#修复建议-24" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>如果可能，使用包含指令时显示执行包含的文件名称</li>
<li>如果必须通过用户的输入指定包含的文件，则最好分析用户的输入，然后从文件白名单中显示地选择</li>
<li>对用户的输入进行严格的过滤，确保其包含的文件在预定的目录中或不能包含URL参数。</li>
</ul>
<h2 id="0x26-短文件名泄露漏洞–中危"><a href="#0x26-短文件名泄露漏洞–中危" class="headerlink" title="0x26 短文件名泄露漏洞–中危"></a>0x26 短文件名泄露漏洞–中危</h2><h3 id="漏洞描述-25"><a href="#漏洞描述-25" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>该漏洞由于Windows处理较长文件名时为方便使用较短的文件名代替，攻击者可利用该漏洞尝试获取网站服务器下的文件名。</p>
<h3 id="漏洞危害-25"><a href="#漏洞危害-25" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>攻击者可通过该漏洞尝试获取网站服务器下存放文件的文件名，达到获取更多信息来入侵服务器的目的</p>
<h3 id="修复建议-25"><a href="#修复建议-25" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>修改Windows配置，关闭短文件名功能</li>
<li>部署web应用防火墙，防止攻击者批量尝试</li>
</ul>
<h2 id="0x27-OS注入漏洞–高危"><a href="#0x27-OS注入漏洞–高危" class="headerlink" title="0x27 OS注入漏洞–高危"></a>0x27 OS注入漏洞–高危</h2><h3 id="漏洞描述-26"><a href="#漏洞描述-26" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>网站应用程序在编写时未对用户提交至服务器的数据进行合法性校验，允许用户能够提交系统命令操作，会导致攻击者能控制整个服务器</p>
<h3 id="漏洞危害-26"><a href="#漏洞危害-26" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>攻击者可以执行任意操作系统命令，进行恶意攻击</p>
<h3 id="修复建议-26"><a href="#修复建议-26" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>进制调用系统问题；</li>
<li>部署web应用防火墙</li>
<li>过滤用户输入</li>
</ul>
<h2 id="0x28-SOAP注入漏洞–高危"><a href="#0x28-SOAP注入漏洞–高危" class="headerlink" title="0x28 SOAP注入漏洞–高危"></a>0x28 SOAP注入漏洞–高危</h2><h3 id="漏洞描述-27"><a href="#漏洞描述-27" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>用户提交的数据直接插入到SOAP消息中，攻击者可以破坏消息结构，从而实现SOAP注入</p>
<h3 id="漏洞危害-27"><a href="#漏洞危害-27" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>攻击者可以改变应用程序的逻辑，修改数据</p>
<h3 id="修复建议-27"><a href="#修复建议-27" class="headerlink" title="修复建议"></a>修复建议</h3><p>在用户提交的数据被插入SOAP消息的实施便捷进行过滤。</p>
<h2 id="0x29-XPATH注入漏洞–高危"><a href="#0x29-XPATH注入漏洞–高危" class="headerlink" title="0x29 XPATH注入漏洞–高危"></a>0x29 XPATH注入漏洞–高危</h2><h3 id="漏洞描述-28"><a href="#漏洞描述-28" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>网站使用XPATH访问数据，响应用户提交的输入，如果用户的输入未经过过滤就插入到XPath的查询中，攻击者就可以通过控制查询语句来破坏应用程序，或者获取未授权访问的数据</p>
<h3 id="漏洞危害-28"><a href="#漏洞危害-28" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>攻击者可以改变应用程序的逻辑，修改数据</p>
<h3 id="修复建议-28"><a href="#修复建议-28" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>在网页代码中对用户输入的数据进行严格过滤</li>
<li>部署web应用防火墙</li>
</ul>
<h2 id="0x30-SMTP注入漏洞–高危"><a href="#0x30-SMTP注入漏洞–高危" class="headerlink" title="0x30 SMTP注入漏洞–高危"></a>0x30 SMTP注入漏洞–高危</h2><h3 id="漏洞描述-29"><a href="#漏洞描述-29" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>在电子邮件功能中，攻击者可在会话中注入任意SMTP命令，完全控制应用程序的消息</p>
<h3 id="漏洞危害-29"><a href="#漏洞危害-29" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>篡改用户的邮件内容</li>
</ul>
<h3 id="修复建议-29"><a href="#修复建议-29" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>在客户端代码中对用户输入的数据畸形严格过滤；</li>
<li>部署web应用防火墙</li>
</ul>
<h2 id="0x31-LDAP注入漏洞–高危"><a href="#0x31-LDAP注入漏洞–高危" class="headerlink" title="0x31 LDAP注入漏洞–高危"></a>0x31 LDAP注入漏洞–高危</h2><h3 id="漏洞描述-30"><a href="#漏洞描述-30" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>LDAP是一种轻量级目录访问协议，可以用来保存信息，如果在查询语句中插入恶意代码，可以修改返回的结果</p>
<h3 id="漏洞危害-30"><a href="#漏洞危害-30" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>机密数据被窃取</li>
</ul>
<h3 id="修复建议-30"><a href="#修复建议-30" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>在查询中对用户输入的数据进行严格过滤</li>
<li>部署web应用防火墙</li>
</ul>
<h2 id="0x32-命令执行漏洞–高危"><a href="#0x32-命令执行漏洞–高危" class="headerlink" title="0x32 命令执行漏洞–高危"></a>0x32 命令执行漏洞–高危</h2><h3 id="漏洞描述-31"><a href="#漏洞描述-31" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>命令执行漏洞是指代码未对用户可控参数做过滤，导致直接带入执行命令的代码中，对恶意构造的语句，可被用来执行任意命令</p>
<h3 id="漏洞危害-31"><a href="#漏洞危害-31" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>攻击者可在服务器上执行任意命令，写入后门，从而入侵服务器，获取服务器的管理员权限，危害巨大</p>
<h3 id="修复建议-31"><a href="#修复建议-31" class="headerlink" title="修复建议"></a>修复建议</h3><p>严格过滤用户输入的数据，禁止执行系统命令</p>
<h2 id="0x33-HTTP消息头注入漏洞"><a href="#0x33-HTTP消息头注入漏洞" class="headerlink" title="0x33 HTTP消息头注入漏洞"></a>0x33 HTTP消息头注入漏洞</h2><h3 id="漏洞描述-32"><a href="#漏洞描述-32" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>用户控制的数据以不安全的方式插入到应用程序返回的HTTP消息头中，如果攻击者能够在消息头中注入换行符，就能在响应中插入其他HTTP消息头，并且响应主体中写入任意内容</p>
<h3 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h3><p>通过修改参数来判断是否存在漏洞，比如国内某著名网站曾经出现过header注入漏洞，如下URL：<a href="http://www.yyyyyyyyy.com/YYYYWeb/jsp/website/agentInvoke.jsp?agentid=%0D%0AX-foo:%20bar通过抓包时就会发现在报文头有" target="_blank" rel="noopener">http://www.yyyyyyyyy.com/YYYYWeb/jsp/website/agentInvoke.jsp?agentid=%0D%0AX-foo:%20bar通过抓包时就会发现在报文头有</a></p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-foo: <span class="built_in">bar</span>;</span><br></pre></td></tr></table></figure>

<h3 id="漏洞危害-32"><a href="#漏洞危害-32" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>利用HTTP消息头注入漏洞可以控制用户访问页面的返回结果，执行恶意代码</p>
<h3 id="修复建议-32"><a href="#修复建议-32" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>不要把用户控制的输入插入到应用程序返回的HTTP消息头中</li>
<li>部署web应用防火墙<ul>
<li>在设置HTTP响应头的代码中，过滤回车换行（%0d%0a、%0D%0A）字符</li>
<li>不采用有漏洞版本的apache服务器，同时对参数做合法性校验以及长度限制，谨慎的根据用户所传入参数做http返回包的header设置。</li>
</ul>
</li>
</ul>
<h2 id="0x34-验证机制缺陷漏洞–中危"><a href="#0x34-验证机制缺陷漏洞–中危" class="headerlink" title="0x34 验证机制缺陷漏洞–中危"></a>0x34 验证机制缺陷漏洞–中危</h2><h3 id="漏洞描述-33"><a href="#漏洞描述-33" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>由于网站管理后台系统登录无验证码校验，可导致后台用户名密码被暴力破解</p>
<h3 id="漏洞危害-33"><a href="#漏洞危害-33" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>攻击者可利用该漏洞无限次提交用户名密码，从而可以爆破后台用户名密码</li>
<li>暴力破解后登录其中一个账号可进管理后台，攻击者登录网站后台任意增删文件等造成负面影响</li>
<li>攻击者可进一步登录后台查看网站信息，上传恶意脚本文件，获取服务器权限，导致局域网被入侵</li>
</ul>
<h3 id="修复建议-33"><a href="#修复建议-33" class="headerlink" title="修复建议"></a>修复建议</h3><ul>
<li>对该页面进行访问控制，禁止外网IP或非法IP访问后台页面，并增加验证码校验，加强的账号锁定机制</li>
</ul>
<h2 id="0x35-文件包含漏洞"><a href="#0x35-文件包含漏洞" class="headerlink" title="0x35 文件包含漏洞"></a>0x35 文件包含漏洞</h2><h3 id="漏洞描述-34"><a href="#漏洞描述-34" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>文件包含漏洞多数情况出现在PHP中，jsp中也存在，文件包含分为本地包含与远程包含。</p>
<h3 id="漏洞危害-34"><a href="#漏洞危害-34" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><ul>
<li>绕过WAF上传木马文件</li>
<li>加载有害的远程内容，影响程序运行</li>
</ul>
<h3 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><ul>
<li>关闭allow_url_fopen</li>
<li>避免使用include参数</li>
<li>使用web检测文件内容</li>
</ul>
<h2 id="0x36-Elasticsearch未授权访问漏洞"><a href="#0x36-Elasticsearch未授权访问漏洞" class="headerlink" title="0x36 Elasticsearch未授权访问漏洞"></a>0x36 Elasticsearch未授权访问漏洞</h2><h3 id="漏洞描述-35"><a href="#漏洞描述-35" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>elasticsearch是基于java的企业级搜索服务，启动此服务默认开放9200端口，可被非法操作数据。</p>
<h3 id="漏洞检测-1"><a href="#漏洞检测-1" class="headerlink" title="漏洞检测"></a>漏洞检测</h3><p>检测默认端口9200，相当于一个API，任何人访问这个地址，就可以调用api，进行数据的增删改操作</p>
<h3 id="漏洞危害-35"><a href="#漏洞危害-35" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>可被非法操作数据，对网站数据造成影响</p>
<h3 id="修复方案"><a href="#修复方案" class="headerlink" title="修复方案"></a>修复方案</h3><ul>
<li>关闭9200端口</li>
<li>防火墙设置禁止外网访问此端口</li>
</ul>
<h3 id="0x37-Git源代码泄露漏洞"><a href="#0x37-Git源代码泄露漏洞" class="headerlink" title="0x37 Git源代码泄露漏洞"></a>0x37 Git源代码泄露漏洞</h3><h3 id="漏洞描述-36"><a href="#漏洞描述-36" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>服务器将.git文件放在了web目录下，导致可以访问git文件内容，获取源代码</p>
<h3 id="漏洞验证"><a href="#漏洞验证" class="headerlink" title="漏洞验证"></a>漏洞验证</h3><p>验证访问网站.git目录，若git目录可以被访问，即存在此漏洞。</p>
<h3 id="漏洞危害-36"><a href="#漏洞危害-36" class="headerlink" title="漏洞危害"></a>漏洞危害</h3><p>可以通过此漏洞，获取项目源代码</p>
<h3 id="漏洞修复-1"><a href="#漏洞修复-1" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><ul>
<li>删除网站目录下的.git文件</li>
<li>中间件上设置.git目录访问权限，禁止访问</li>
<li>防火墙上设置禁止访问此目录</li>
</ul>
<h2 id="0x38-PHPinfo-信息泄露漏洞"><a href="#0x38-PHPinfo-信息泄露漏洞" class="headerlink" title="0x38 PHPinfo()信息泄露漏洞"></a>0x38 PHPinfo()信息泄露漏洞</h2><h3 id="漏洞描述-37"><a href="#漏洞描述-37" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>web站点的某些测试页面可能会使用到PHP的phpinfo()函数，会输出服务器的关键信息。</p>
<h3 id="检测方式"><a href="#检测方式" class="headerlink" title="检测方式"></a>检测方式</h3><p>访问<code>http://\[ip]\test.php</code>以及<code>http://\[ip]\phpinfo.php</code>看是否能成功</p>
<h3 id="修复建议-34"><a href="#修复建议-34" class="headerlink" title="修复建议"></a>修复建议</h3><p>删除该PHP文件</p>
<h2 id="0x39-Crossdomain-xml配置不当漏洞"><a href="#0x39-Crossdomain-xml配置不当漏洞" class="headerlink" title="0x39  Crossdomain.xml配置不当漏洞"></a>0x39  Crossdomain.xml配置不当漏洞</h2><h3 id="漏洞描述-38"><a href="#漏洞描述-38" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>网站根目录下的文件crossdomain.xml指明远程flash是否可以加载当前网站的资源（图片、网页内容、flash等）如果配置不当，可能带来CSRF攻击。</p>
<h3 id="检测方法"><a href="#检测方法" class="headerlink" title="检测方法"></a>检测方法</h3><p>访问<code>http://\[domain]\/crossdomain.xml</code></p>
<h3 id="修复方案-1"><a href="#修复方案-1" class="headerlink" title="修复方案"></a>修复方案</h3><p>对于不需要外部加载资源的网站，crossdomain.xml中更改allow_access_from的domain属性为域名白名单，修复大致样本如下</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?<span class="type">xml</span> version="1.0"?&gt;</span><br><span class="line">&lt;<span class="keyword">cross</span>-<span class="keyword">domain</span>-<span class="keyword">policy</span>&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure="false" <span class="keyword">domain</span>="*.qq.com"/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure="false" <span class="keyword">domain</span>="*.soso.com"/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure="false" <span class="keyword">domain</span>="*.paipai.com"/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure="false" <span class="keyword">domain</span>="*.gtimg.cn"/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure="false" <span class="keyword">domain</span>="*.pengyou.com"/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure="false" <span class="keyword">domain</span>="app10000.qzoneapp.com"/&gt;</span><br><span class="line">&lt;allow-<span class="keyword">access</span>-<span class="keyword">from</span> secure="false" <span class="keyword">domain</span>="app10000.imgcache.qzoneapp.com"/&gt;</span><br><span class="line">&lt;/<span class="keyword">cross</span>-<span class="keyword">domain</span>-<span class="keyword">policy</span>&gt;</span><br></pre></td></tr></table></figure></div><div class="post-copyright"><blockquote><p>原文作者: fzykn06</p><p>原文链接: <a href="http://fzykn06.github.io/2020/06/29/Web应用漏洞基本原理、危害及修复概述/">http://fzykn06.github.io/2020/06/29/Web应用漏洞基本原理、危害及修复概述/</a></p><p>版权声明: 转载请注明出处(必须保留作者署名及链接)</p></blockquote></div><div class="tags"><a href="/tags/web%E5%AE%89%E5%85%A8/">web安全</a></div><div class="post-share"><div class="social-share"><span>分享到:</span></div><div data-thread-key="2020/06/29/Web应用漏洞基本原理、危害及修复概述/" data-title="Web应用漏洞基本原理、危害及修复概述" data-url="http://fzykn06.github.io/2020/06/29/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E3%80%81%E5%8D%B1%E5%AE%B3%E5%8F%8A%E4%BF%AE%E5%A4%8D%E6%A6%82%E8%BF%B0/" class="ds-share flat"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li data-toggle="ds-share-icons-more"><a href="javascript:void(0);" class="ds-more">分享到:</a></li><li><a href="javascript:void(0);" data-service="weibo" class="ds-weibo">微博</a></li><li><a href="javascript:void(0);" data-service="qzone" class="ds-qzone">QQ空间</a></li><li><a href="javascript:void(0);" data-service="qqt" class="ds-qqt">腾讯微博</a></li><li><a href="javascript:void(0);" data-service="wechat" class="ds-wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div><div class="bdsharebuttonbox"><span style="float:left;line-height: 28px;height: 28px;font-size:16px;font-weight:blod">分享到:</span><a href="#" data-cmd="more" class="bds_more"></a><a href="#" data-cmd="mshare" title="分享到一键分享" class="bds_mshare"></a><a href="#" data-cmd="fbook" title="分享到Facebook" class="bds_fbook"></a><a href="#" data-cmd="twi" title="分享到Twitter" class="bds_twi"></a><a href="#" data-cmd="linkedin" title="分享到linkedin" class="bds_linkedin"></a><a href="#" data-cmd="youdao" title="分享到有道云笔记" class="bds_youdao"></a><a href="#" data-cmd="evernotecn" title="分享到印象笔记" class="bds_evernotecn"></a><a href="#" data-cmd="weixin" title="分享到微信" class="bds_weixin"></a><a href="#" data-cmd="qzone" title="分享到QQ空间" class="bds_qzone"></a><a href="#" data-cmd="tsina" title="分享到新浪微博" class="bds_tsina"></a></div><div class="jiathis_style"><span class="jiathis_txt">分享到:</span><a class="jiathis_button_tsina"></a><a class="jiathis_button_qzone"></a><a class="jiathis_button_weixin"></a><a class="jiathis_button_fb"></a><a class="jiathis_button_linkedin"></a><a class="jiathis_button_twitter"></a><a class="jiathis_button_ydnote"></a><a href="http://www.jiathis.com/share" target="_blank" rel="noopener" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis"></a><a class="jiathis_counter_style"></a></div></div><div class="post-nav"><a href="/2020/06/29/Web%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E3%80%81%E5%8D%B1%E5%AE%B3%E5%8F%8A%E4%BF%AE%E5%A4%8D%E6%A6%82%E8%BF%B0/" class="pre">Web系统漏洞基本原理、危害及修复概述</a><a href="/2020/06/29/Web%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E3%80%81%E5%8D%B1%E5%AE%B3%E5%8F%8A%E4%BF%AE%E5%A4%8D%E6%A6%82%E8%BF%B0/" class="next">Web中间件漏洞基本原理、危害及修复概述</a></div><div id="comments"><div id="container"><script type="text/javascript" src="https://unpkg.com/gitalk/dist/gitalk.min.js?v=2.0.4"></script><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=2.0.4"></script><script>var gitalk = new Gitalk({
  clientID: '1817bee0e9bebbfec568',
  clientSecret: '0fed554209288ad9037d80cb0f5512d26423ad31',
  repo: 'fzykn06.github.io',
  owner: 'fzykn06',
  admin: ['fzykn06'],
  id: md5(window.location.pathname),
  distractionFreeMode: false,
  language: 'zh-CN',
  pagerDirection: 'last'
})
gitalk.render('container')</script></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-SQL注入漏洞–高危"><span class="toc-text">0x01 SQL注入漏洞–高危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-目录遍历漏洞–中危"><span class="toc-text">0x02 目录遍历漏洞–中危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-1"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-1"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-1"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-跨站脚本漏洞（XSS）"><span class="toc-text">0x03 跨站脚本漏洞（XSS）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-2"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-2"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-2"><span class="toc-text">修复建议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#设置httponly"><span class="toc-text">设置httponly</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XSS-filter"><span class="toc-text">XSS filter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#编码转义"><span class="toc-text">编码转义</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#处理富文本"><span class="toc-text">处理富文本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#输出类型xss漏洞"><span class="toc-text">输出类型xss漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#其他修复"><span class="toc-text">其他修复</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-未过滤HTM代码漏洞"><span class="toc-text">0x04 未过滤HTM代码漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-3"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-3"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-3"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-数据库运行出错"><span class="toc-text">0x05 数据库运行出错</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-4"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-4"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-4"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-Flash安全配置缺陷漏洞"><span class="toc-text">0x06 Flash安全配置缺陷漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-5"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-5"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-5"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-FCK编辑器泄露漏洞"><span class="toc-text">0x07 FCK编辑器泄露漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-6"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-6"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-6"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-FCK-editor任意文件上传漏洞"><span class="toc-text">0x08 FCK editor任意文件上传漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-7"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-7"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-7"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-URL-Redirect漏洞"><span class="toc-text">0x09 URL Redirect漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-8"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-8"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-8"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-文件上传漏洞"><span class="toc-text">0x10 文件上传漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-9"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-9"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-9"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11-后台弱口令漏洞"><span class="toc-text">0x11 后台弱口令漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-10"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-10"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-10"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12-敏感信息泄露漏洞"><span class="toc-text">0x12 敏感信息泄露漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-11"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-11"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-11"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x13-未加密登录请求漏洞"><span class="toc-text">0x13 未加密登录请求漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-12"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-12"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-12"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x14-后台口令暴力破解"><span class="toc-text">0x14 后台口令暴力破解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-13"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-13"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-13"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x15-跨站请求伪造（CSRF）"><span class="toc-text">0x15 跨站请求伪造（CSRF）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-14"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-14"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-14"><span class="toc-text">修复建议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#服务器端防御"><span class="toc-text">服务器端防御</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#客户端防御"><span class="toc-text">客户端防御</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x16-Unicode编码转换漏洞–中危"><span class="toc-text">0x16 Unicode编码转换漏洞–中危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-15"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-15"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-15"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x17-Possible-Net-Error-Message–中危"><span class="toc-text">0x17 Possible .Net Error Message–中危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-16"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-16"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-16"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x18-发生内部错误漏洞"><span class="toc-text">0x18 发生内部错误漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-17"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-17"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-17"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x19-SVN源代码泄露"><span class="toc-text">0x19 SVN源代码泄露</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-18"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-18"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-18"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x20-旁站攻击漏洞"><span class="toc-text">0x20 旁站攻击漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-19"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-19"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-19"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x21-后台登录页面绕过"><span class="toc-text">0x21 后台登录页面绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-20"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-20"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-20"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x22-CVS信息泄露"><span class="toc-text">0x22 CVS信息泄露</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-21"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞测试"><span class="toc-text">漏洞测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-21"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-21"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x23-Possible-PHP-Error-Message"><span class="toc-text">0x23 Possible PHP Error Message</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-22"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-22"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-22"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x24-HPP漏洞"><span class="toc-text">0x24 HPP漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-23"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-23"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-23"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x25-File-Operation-Web-xml漏洞"><span class="toc-text">0x25 File Operation-Web.xml漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-24"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-24"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-24"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x26-短文件名泄露漏洞–中危"><span class="toc-text">0x26 短文件名泄露漏洞–中危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-25"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-25"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-25"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x27-OS注入漏洞–高危"><span class="toc-text">0x27 OS注入漏洞–高危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-26"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-26"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-26"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x28-SOAP注入漏洞–高危"><span class="toc-text">0x28 SOAP注入漏洞–高危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-27"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-27"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-27"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x29-XPATH注入漏洞–高危"><span class="toc-text">0x29 XPATH注入漏洞–高危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-28"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-28"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-28"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x30-SMTP注入漏洞–高危"><span class="toc-text">0x30 SMTP注入漏洞–高危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-29"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-29"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-29"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x31-LDAP注入漏洞–高危"><span class="toc-text">0x31 LDAP注入漏洞–高危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-30"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-30"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-30"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x32-命令执行漏洞–高危"><span class="toc-text">0x32 命令执行漏洞–高危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-31"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-31"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-31"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x33-HTTP消息头注入漏洞"><span class="toc-text">0x33 HTTP消息头注入漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-32"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞检测"><span class="toc-text">漏洞检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-32"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-32"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x34-验证机制缺陷漏洞–中危"><span class="toc-text">0x34 验证机制缺陷漏洞–中危</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-33"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-33"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-33"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x35-文件包含漏洞"><span class="toc-text">0x35 文件包含漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-34"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-34"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞修复"><span class="toc-text">漏洞修复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x36-Elasticsearch未授权访问漏洞"><span class="toc-text">0x36 Elasticsearch未授权访问漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-35"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞检测-1"><span class="toc-text">漏洞检测</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-35"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复方案"><span class="toc-text">修复方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x37-Git源代码泄露漏洞"><span class="toc-text">0x37 Git源代码泄露漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-36"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞验证"><span class="toc-text">漏洞验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞危害-36"><span class="toc-text">漏洞危害</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞修复-1"><span class="toc-text">漏洞修复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x38-PHPinfo-信息泄露漏洞"><span class="toc-text">0x38 PHPinfo()信息泄露漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-37"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#检测方式"><span class="toc-text">检测方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复建议-34"><span class="toc-text">修复建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x39-Crossdomain-xml配置不当漏洞"><span class="toc-text">0x39  Crossdomain.xml配置不当漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#漏洞描述-38"><span class="toc-text">漏洞描述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#检测方法"><span class="toc-text">检测方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修复方案-1"><span class="toc-text">修复方案</span></a></li></ol></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/06/29/Web%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E3%80%81%E5%8D%B1%E5%AE%B3%E5%8F%8A%E4%BF%AE%E5%A4%8D%E6%A6%82%E8%BF%B0/">Web系统漏洞基本原理、危害及修复概述</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/29/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E3%80%81%E5%8D%B1%E5%AE%B3%E5%8F%8A%E4%BF%AE%E5%A4%8D%E6%A6%82%E8%BF%B0/">Web应用漏洞基本原理、危害及修复概述</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/29/Web%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86%E3%80%81%E5%8D%B1%E5%AE%B3%E5%8F%8A%E4%BF%AE%E5%A4%8D%E6%A6%82%E8%BF%B0/">Web中间件漏洞基本原理、危害及修复概述</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/12/27/sqli-labs-writeup/">sqli-labs-writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/09/28/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E8%80%83%E6%A0%B8%E9%83%A8%E5%88%86writeup/">实验室考核部分writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/16/%E7%BD%91%E7%BB%9C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%AF%BE%E8%AE%BE-%E5%9F%BA%E4%BA%8Ephp%E4%B8%8Ehtml%E7%9A%84cpu%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95/">网络操作系统课设--基于php与html的cpu调度算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/19/ubuntu16-04-%E6%90%AD%E5%BB%BAemail%E6%9C%8D%E5%8A%A1%E5%99%A8/">ubuntu16.04 搭建email服务器</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/16/ISCC2019%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/">ISCC2019部分题解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/11/ubuntu16-04-%E6%90%AD%E5%BB%BAftp%E6%9C%8D%E5%8A%A1%E5%99%A8/">ubuntu16.04 搭建ftp服务器</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/05/ubuntu16-04-%E6%90%AD%E5%BB%BAWeb%E6%9C%8D%E5%8A%A1%E5%99%A8/">ubuntu16.04 搭建Web服务器</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/CTF/" style="font-size: 15px;">CTF</a> <a href="/tags/web%E5%AE%89%E5%85%A8/" style="font-size: 15px;">web安全</a> <a href="/tags/Subject/" style="font-size: 15px;">Subject</a> <a href="/tags/start/" style="font-size: 15px;">start</a> <a href="/tags/ctf/" style="font-size: 15px;">ctf</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">10</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="https://nikoeurus.github.io/" title="Somnus's blog" target="_blank">Somnus's blog</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |  <a href="/atom.xml">订阅本站</a> |  <a href="/about/">联系博主</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">fzykn06.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/" target="_blank" rel="noopener"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.4"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.4" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","weixin","tsina","qzone","linkedin","fbook","twi","print","renren","sqq","evernotecn","bdysc","tqq","tqf","bdxc","kaixin001","tieba","douban","bdhome","thx","ibaidu","meilishuo","mogujie","diandian","huaban","duitang","hx","fx","youdao","sdo","qingbiji","people","xinhua","mail","isohu","yaolan","wealink","ty","iguba","h163","copy"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{},"image":{"viewList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"]}};with(document)0[(getElementsByTagName('head')[0]||head).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script><script>var jiathis_config={
    data_track_clickback:true,
    summary:"",
    shortUrl:true,
    hideMore:false
}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script></body></html>